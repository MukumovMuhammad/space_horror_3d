[gd_scene load_steps=27 format=3 uid="uid://vlxpbjdahh7m"]

[ext_resource type="Script" path="res://Scripts/monster_follower.gd" id="1_rjyqo"]
[ext_resource type="Script" path="res://Scripts/Vission_area.gd" id="2_o8eyv"]
[ext_resource type="PackedScene" uid="uid://csbjw8vmwitpp" path="res://Assets/a_monster.glb" id="2_ux8fm"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_1qewk"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_pwvne"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jcdtg"]
animation = &"mutant_idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qxjxg"]
animation = &"mutant_walking"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kmte7"]
animation = &"running"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5a8nx"]
animation = &"screaming"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_k1yv3"]
animation = &"side_attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8c12t"]
animation = &"sound_reaction"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_mgb5a"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_27e0x"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"heard"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7fwmi"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2
advance_condition = &"see"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lfcel"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ybxq7"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"see"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_thw2p"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ipoii"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yj1a3"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qwkre"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"lost"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xpbg3"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"lost"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_6qdxu"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hs56s"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"got_home"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ic8y1"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"see"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qww6y"]
advance_mode = 2
advance_condition = &"going_to_pos"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_d2to1"]
states/End/position = Vector2(1094.4, 68.224)
states/Start/position = Vector2(188.8, 100.16)
states/idle/node = SubResource("AnimationNodeAnimation_pwvne")
states/idle/position = Vector2(384.8, 165.149)
states/mutant_idle/node = SubResource("AnimationNodeAnimation_jcdtg")
states/mutant_idle/position = Vector2(615.44, 201.856)
states/mutant_walking/node = SubResource("AnimationNodeAnimation_qxjxg")
states/mutant_walking/position = Vector2(615.451, 94.8046)
states/running/node = SubResource("AnimationNodeAnimation_kmte7")
states/running/position = Vector2(753.6, 68.2595)
states/screaming/node = SubResource("AnimationNodeAnimation_5a8nx")
states/screaming/position = Vector2(664, -11.6)
states/side_attack/node = SubResource("AnimationNodeAnimation_k1yv3")
states/side_attack/position = Vector2(803.4, 166.355)
states/sound_reaction/node = SubResource("AnimationNodeAnimation_8c12t")
states/sound_reaction/position = Vector2(418.4, -10.8)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_mgb5a"), "idle", "sound_reaction", SubResource("AnimationNodeStateMachineTransition_27e0x"), "sound_reaction", "screaming", SubResource("AnimationNodeStateMachineTransition_7fwmi"), "sound_reaction", "mutant_walking", SubResource("AnimationNodeStateMachineTransition_lfcel"), "mutant_walking", "screaming", SubResource("AnimationNodeStateMachineTransition_ybxq7"), "screaming", "running", SubResource("AnimationNodeStateMachineTransition_thw2p"), "running", "side_attack", SubResource("AnimationNodeStateMachineTransition_ipoii"), "side_attack", "running", SubResource("AnimationNodeStateMachineTransition_yj1a3"), "mutant_walking", "mutant_idle", SubResource("AnimationNodeStateMachineTransition_qwkre"), "running", "mutant_idle", SubResource("AnimationNodeStateMachineTransition_xpbg3"), "mutant_idle", "mutant_walking", SubResource("AnimationNodeStateMachineTransition_6qdxu"), "mutant_walking", "idle", SubResource("AnimationNodeStateMachineTransition_hs56s"), "idle", "screaming", SubResource("AnimationNodeStateMachineTransition_ic8y1"), "idle", "mutant_walking", SubResource("AnimationNodeStateMachineTransition_qww6y")]
graph_offset = Vector2(113, 22.7024)

[node name="Alien" type="CharacterBody3D" groups=["noise_listener"]]
collision_layer = 2
collision_mask = 3
floor_max_angle = 1.0472
floor_snap_length = 0.2
script = ExtResource("1_rjyqo")

[node name="a_monster" parent="." instance=ExtResource("2_ux8fm")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="idle" parent="a_monster" index="0"]
transform = Transform3D(0.01, 0, 0, 0, 0, -0.01, 0, 0.01, 0, 0, -1, 0)

[node name="Skeleton3D" parent="a_monster/idle" index="0"]
bones/0/position = Vector3(0.218715, 0.628761, -84.837)
bones/0/rotation = Quaternion(-0.710191, -0.00704054, -0.00630611, 0.703945)
bones/1/rotation = Quaternion(0.148131, 0.00191315, 0.00358645, 0.988959)
bones/1/scale = Vector3(1, 1, 1)
bones/2/rotation = Quaternion(0.164749, 0.00320976, 0.0074463, 0.986302)
bones/3/rotation = Quaternion(0.111302, 0.00279874, 0.0077507, 0.993752)
bones/3/scale = Vector3(1, 1, 1)
bones/4/rotation = Quaternion(0.00856705, -0.00765981, 0.000381844, 0.999934)
bones/5/rotation = Quaternion(-0.204277, 0.0273144, -0.0164606, 0.978393)
bones/8/rotation = Quaternion(-0.730201, -0.422328, 0.410175, -0.3467)
bones/9/position = Vector3(1.86468e-05, 18.002, 2.99399e-06)
bones/9/rotation = Quaternion(0.0258309, -0.156159, 0.259479, 0.95269)
bones/9/scale = Vector3(1, 1, 1)
bones/10/position = Vector3(3.23214e-07, 37.5201, 4.26229e-06)
bones/10/rotation = Quaternion(0.149026, 0.0615251, 0.46154, 0.872346)
bones/11/position = Vector3(-2.37547e-07, 41.8656, -3.04517e-06)
bones/11/rotation = Quaternion(0.0576092, -0.433326, 0.199166, 0.877065)
bones/12/rotation = Quaternion(0.382098, 0.290032, 0.0678563, 0.874802)
bones/12/scale = Vector3(1, 1, 1)
bones/13/rotation = Quaternion(-0.0893735, 0.00750935, -0.223374, 0.970598)
bones/14/position = Vector3(2.06231e-05, 4.44681, -3.26932e-05)
bones/14/rotation = Quaternion(-0.0943221, 0.0036984, -0.18031, 0.97907)
bones/16/rotation = Quaternion(0.19023, -0.0124973, -0.0764432, 0.978679)
bones/17/position = Vector3(6.29379e-06, 6.30651, 3.8779e-06)
bones/17/rotation = Quaternion(0.190297, 2.82751e-07, -0.0186034, 0.98155)
bones/18/position = Vector3(-1.75834e-06, 5.287, 2.19233e-06)
bones/18/rotation = Quaternion(0.235803, 0.002976, -0.00782032, 0.971765)
bones/19/position = Vector3(2.29478e-06, 4.6436, -4.96022e-06)
bones/20/position = Vector3(-0.112404, 18.0099, -0.441073)
bones/20/rotation = Quaternion(0.190228, -0.0124972, -0.0764424, 0.97868)
bones/20/scale = Vector3(1, 1, 1)
bones/21/rotation = Quaternion(0.1903, -1.69485e-07, -0.018606, 0.98155)
bones/22/rotation = Quaternion(0.190297, 3.60555e-08, -0.0186052, 0.98155)
bones/24/position = Vector3(5.8325, 16.5926, -0.117362)
bones/24/rotation = Quaternion(0.190213, -0.0124966, -0.0764418, 0.978683)
bones/24/scale = Vector3(1, 1, 1)
bones/25/position = Vector3(4.87544e-06, 6.3329, 6.839e-06)
bones/25/rotation = Quaternion(0.190284, -1.07383e-06, -0.0186089, 0.981553)
bones/26/rotation = Quaternion(0.190282, -5.74039e-08, -0.0186037, 0.981553)
bones/27/position = Vector3(-7.15256e-07, 4.4897, 5.16325e-06)
bones/28/position = Vector3(11.1436, 14.8206, 0.00181794)
bones/28/rotation = Quaternion(0.190217, -0.0125599, -0.0763857, 0.978685)
bones/29/position = Vector3(-2.42056e-06, 5.5763, -3.193e-06)
bones/29/rotation = Quaternion(0.19029, -6.15731e-05, -0.0185389, 0.981553)
bones/30/position = Vector3(8.34465e-07, 4.0902, 5.37932e-06)
bones/30/rotation = Quaternion(0.19029, -6.51438e-05, -0.0185577, 0.981553)
bones/31/position = Vector3(4.17233e-06, 4.2223, -4.39584e-06)
bones/31/rotation = Quaternion(-8.46545e-16, 1.16415e-10, 2.05044e-15, 1)
bones/32/rotation = Quaternion(0.704297, -0.434052, 0.443369, 0.344947)
bones/32/scale = Vector3(1, 1, 1)
bones/33/position = Vector3(-1.32484e-05, 18.0019, 3.55167e-06)
bones/33/rotation = Quaternion(0.103847, 0.155762, -0.202158, 0.961294)
bones/33/scale = Vector3(1, 1, 1)
bones/34/rotation = Quaternion(0.131857, 0.106384, -0.569808, 0.804124)
bones/35/rotation = Quaternion(0.138707, 0.15661, 0.00250797, 0.977869)
bones/35/scale = Vector3(1, 1, 1)
bones/36/rotation = Quaternion(0.438219, -0.311148, -0.109045, 0.836218)
bones/36/scale = Vector3(1, 1, 1)
bones/37/rotation = Quaternion(-0.110446, -0.0558155, 0.21522, 0.968693)
bones/38/rotation = Quaternion(-0.132958, -0.0878296, 0.154493, 0.975059)
bones/39/position = Vector3(2.44379e-06, 5.3385, 1.28149e-06)
bones/40/rotation = Quaternion(0.26758, -0.154835, 0.0552435, 0.949408)
bones/40/scale = Vector3(1, 1, 1)
bones/41/rotation = Quaternion(0.258583, 0.00756779, -0.0874427, 0.961994)
bones/42/position = Vector3(-5.84331e-06, 5.287, -5.74267e-06)
bones/42/rotation = Quaternion(0.128809, 0.038892, -0.107539, 0.985054)
bones/44/position = Vector3(0.112393, 18.0096, -0.4408)
bones/44/rotation = Quaternion(0.231773, 0.0282011, 0.00211652, 0.972359)
bones/44/scale = Vector3(1, 1, 1)
bones/45/rotation = Quaternion(0.251282, -0.000755892, 0.0248877, 0.967594)
bones/46/rotation = Quaternion(0.289772, -6.67912e-06, 0.0283689, 0.956675)
bones/48/position = Vector3(-5.8325, 16.5924, -0.117301)
bones/48/rotation = Quaternion(0.220397, 0.125853, 0.0381719, 0.966504)
bones/48/scale = Vector3(1, 1, 1)
bones/49/position = Vector3(-8.53317e-07, 6.333, 1.78771e-06)
bones/49/rotation = Quaternion(0.252694, 0.0950115, 0.0506017, 0.961539)
bones/50/position = Vector3(-2.14577e-06, 5.60899, 2.52202e-06)
bones/50/rotation = Quaternion(0.290454, 0.0945716, 0.0580005, 0.950436)
bones/51/position = Vector3(1.78814e-06, 4.49002, 3.23728e-06)
bones/52/position = Vector3(-11.1437, 14.8205, 0.00240044)
bones/52/rotation = Quaternion(0.18658, 0.122788, -0.0466785, 0.973618)
bones/52/scale = Vector3(1, 1, 1)
bones/53/position = Vector3(-3.3997e-07, 5.57602, -2.11115e-06)
bones/53/rotation = Quaternion(0.293525, 9.63171e-06, 0.0286054, 0.955523)
bones/54/rotation = Quaternion(0.364329, -5.66775e-05, 0.0357805, 0.930583)
bones/55/position = Vector3(-6.07967e-06, 4.22301, 3.39001e-06)
bones/56/rotation = Quaternion(0.0669377, 0.370342, 0.89445, -0.241504)
bones/56/scale = Vector3(1, 1, 0.999995)
bones/57/rotation = Quaternion(-0.567448, 0.0168204, -0.0860824, 0.818725)
bones/58/rotation = Quaternion(0.556374, -0.0325549, -0.0448252, 0.829083)
bones/59/rotation = Quaternion(0.400443, -0.0288801, -0.118962, 0.908108)
bones/59/scale = Vector3(1, 1, 1)
bones/60/rotation = Quaternion(-1.7679e-08, 1.35886e-08, -7.42743e-09, 1)
bones/61/rotation = Quaternion(-0.145566, 0.375538, 0.896879, 0.182729)
bones/61/scale = Vector3(1, 1, 0.999995)
bones/62/rotation = Quaternion(-0.564935, -0.0699137, 0.00818055, 0.822127)
bones/63/rotation = Quaternion(0.546885, 0.0877886, 0.05252, 0.830934)
bones/63/scale = Vector3(1, 1, 1)
bones/64/rotation = Quaternion(0.386331, 0.123543, 0.132561, 0.904386)
bones/65/rotation = Quaternion(1.42063e-08, -3.44021e-08, 1.11474e-08, 1)

[node name="AnimationPlayer" parent="a_monster" index="1"]
autoplay = "running"

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_1qewk")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
height = 1.5
radius = 1.0
debug_enabled = true

[node name="Vission_area" type="Node3D" parent="." node_paths=PackedStringArray("parent")]
script = ExtResource("2_o8eyv")
parent = NodePath("..")

[node name="RayCast3D" type="RayCast3D" parent="Vission_area"]
transform = Transform3D(1, 0, 0, 0, 0.99985, -0.0172954, 0, 0.0172954, 0.99985, -0.0817828, 0.810395, -0.516692)
target_position = Vector3(0, 0, -40)
collision_mask = 6

[node name="Label3D" type="Label3D" parent="."]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 1.5, 0)
font_size = 40

[node name="enemy_movement" type="Node" parent="."]

[node name="AnimationTree" type="AnimationTree" parent="."]
active = false
root_node = NodePath("../a_monster")
tree_root = SubResource("AnimationNodeStateMachine_d2to1")
anim_player = NodePath("../a_monster/AnimationPlayer")
parameters/conditions/attack = false
parameters/conditions/going_to_pos = false
parameters/conditions/got_home = false
parameters/conditions/heard = false
parameters/conditions/lost = false
parameters/conditions/see = false

[node name="rot_point" type="Marker3D" parent="."]

[connection signal="bodies_count" from="Vission_area" to="." method="_on_vission_area_bodies_count"]
[connection signal="animation_started" from="AnimationTree" to="." method="_on_animation_tree_animation_started"]

[editable path="a_monster"]
