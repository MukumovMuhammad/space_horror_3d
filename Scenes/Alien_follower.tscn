[gd_scene load_steps=27 format=3 uid="uid://vlxpbjdahh7m"]

[ext_resource type="Script" path="res://Scripts/monster_follower.gd" id="1_rjyqo"]
[ext_resource type="Script" path="res://Scripts/Vission_area.gd" id="2_o8eyv"]
[ext_resource type="PackedScene" uid="uid://csbjw8vmwitpp" path="res://Assets/a_monster.glb" id="2_ux8fm"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_1qewk"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_pwvne"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jcdtg"]
animation = &"mutant_idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qxjxg"]
animation = &"mutant_walking"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kmte7"]
animation = &"running"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5a8nx"]
animation = &"screaming"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_k1yv3"]
animation = &"side_attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8c12t"]
animation = &"sound_reaction"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_mgb5a"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_27e0x"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"heard"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7fwmi"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2
advance_condition = &"see"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lfcel"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ybxq7"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"see"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_thw2p"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ipoii"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yj1a3"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qwkre"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"lost"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xpbg3"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"lost"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_6qdxu"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hs56s"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"got_home"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ic8y1"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"see"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qww6y"]
advance_mode = 2
advance_condition = &"going_to_pos"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_d2to1"]
states/End/position = Vector2(1094.4, 68.224)
states/Start/position = Vector2(188.8, 100.16)
states/idle/node = SubResource("AnimationNodeAnimation_pwvne")
states/idle/position = Vector2(385.8, 166.355)
states/mutant_idle/node = SubResource("AnimationNodeAnimation_jcdtg")
states/mutant_idle/position = Vector2(615.44, 201.856)
states/mutant_walking/node = SubResource("AnimationNodeAnimation_qxjxg")
states/mutant_walking/position = Vector2(615.44, 94.8046)
states/running/node = SubResource("AnimationNodeAnimation_kmte7")
states/running/position = Vector2(753.6, 68.2595)
states/screaming/node = SubResource("AnimationNodeAnimation_5a8nx")
states/screaming/position = Vector2(664, -11.6)
states/side_attack/node = SubResource("AnimationNodeAnimation_k1yv3")
states/side_attack/position = Vector2(803.4, 166.355)
states/sound_reaction/node = SubResource("AnimationNodeAnimation_8c12t")
states/sound_reaction/position = Vector2(418.4, -10.8)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_mgb5a"), "idle", "sound_reaction", SubResource("AnimationNodeStateMachineTransition_27e0x"), "sound_reaction", "screaming", SubResource("AnimationNodeStateMachineTransition_7fwmi"), "sound_reaction", "mutant_walking", SubResource("AnimationNodeStateMachineTransition_lfcel"), "mutant_walking", "screaming", SubResource("AnimationNodeStateMachineTransition_ybxq7"), "screaming", "running", SubResource("AnimationNodeStateMachineTransition_thw2p"), "running", "side_attack", SubResource("AnimationNodeStateMachineTransition_ipoii"), "side_attack", "running", SubResource("AnimationNodeStateMachineTransition_yj1a3"), "mutant_walking", "mutant_idle", SubResource("AnimationNodeStateMachineTransition_qwkre"), "running", "mutant_idle", SubResource("AnimationNodeStateMachineTransition_xpbg3"), "mutant_idle", "mutant_walking", SubResource("AnimationNodeStateMachineTransition_6qdxu"), "mutant_walking", "idle", SubResource("AnimationNodeStateMachineTransition_hs56s"), "idle", "screaming", SubResource("AnimationNodeStateMachineTransition_ic8y1"), "idle", "mutant_walking", SubResource("AnimationNodeStateMachineTransition_qww6y")]
graph_offset = Vector2(120, -202.298)

[node name="Alien" type="CharacterBody3D" groups=["noise_listener"]]
collision_layer = 2
collision_mask = 3
floor_max_angle = 1.0472
floor_snap_length = 0.2
script = ExtResource("1_rjyqo")

[node name="a_monster" parent="." instance=ExtResource("2_ux8fm")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="idle" parent="a_monster" index="0"]
transform = Transform3D(0.01, 0, 0, 0, 0, -0.01, 0, 0.01, 0, 0, -1, 0)

[node name="Skeleton3D" parent="a_monster/idle" index="0"]
bones/0/position = Vector3(-4.3447, 4.62051, -71.1795)
bones/0/rotation = Quaternion(-0.5581, 0.396009, -0.350541, 0.639392)
bones/1/rotation = Quaternion(0.0696127, 0.0399963, -0.0201523, 0.996568)
bones/1/scale = Vector3(1, 1, 1)
bones/2/rotation = Quaternion(0.109954, 0.0545615, -0.044754, 0.991428)
bones/3/position = Vector3(-1.67649e-08, 11.8996, 1.08897e-05)
bones/3/rotation = Quaternion(0.105556, 0.0546574, -0.0453251, 0.991875)
bones/3/scale = Vector3(1, 1, 1)
bones/4/rotation = Quaternion(0.199326, -0.142389, -0.0560203, 0.967913)
bones/5/rotation = Quaternion(-0.169811, -0.0397576, 0.284112, 0.942796)
bones/8/rotation = Quaternion(-0.676766, -0.314462, 0.592892, -0.302624)
bones/9/position = Vector3(2.29413e-05, 18.002, -1.03014e-06)
bones/9/rotation = Quaternion(0.045604, -0.0444065, 0.247635, 0.96676)
bones/9/scale = Vector3(1, 1, 1)
bones/10/position = Vector3(-3.49148e-06, 37.5201, 4.47595e-07)
bones/10/rotation = Quaternion(0.0393524, 0.192712, 0.622177, 0.757766)
bones/11/position = Vector3(6.0082e-06, 41.8656, -2.83929e-06)
bones/11/rotation = Quaternion(0.0495044, -0.42855, 0.210856, 0.877174)
bones/12/rotation = Quaternion(0.427721, 0.242841, 0.170079, 0.853906)
bones/12/scale = Vector3(1, 1, 1)
bones/13/position = Vector3(4.29153e-06, 6.98191, 1.43051e-06)
bones/13/rotation = Quaternion(-0.0882877, -0.00450178, -0.348547, 0.933113)
bones/14/position = Vector3(-6.07969e-06, 4.4468, -3.12923e-06)
bones/14/rotation = Quaternion(-0.0761297, -0.0241799, -0.436548, 0.896128)
bones/15/position = Vector3(-3.93386e-06, 5.338, -1.51995e-06)
bones/16/position = Vector3(-6.3457, 17.4729, 0.144191)
bones/16/rotation = Quaternion(0.240918, -0.0148627, -0.082689, 0.966902)
bones/17/position = Vector3(-1.57402e-06, 6.3065, 1.2553e-06)
bones/17/rotation = Quaternion(0.232177, -8.21269e-08, -0.0226997, 0.972409)
bones/18/position = Vector3(8.9705e-06, 5.287, 1.7155e-06)
bones/18/rotation = Quaternion(0.277212, 0.00361307, -0.0119483, 0.960728)
bones/19/position = Vector3(1.57952e-06, 4.6436, -6.39074e-06)
bones/20/position = Vector3(-0.112398, 18.0099, -0.441105)
bones/20/rotation = Quaternion(0.306153, -0.018846, -0.0879095, 0.947727)
bones/20/scale = Vector3(1, 1, 1)
bones/21/rotation = Quaternion(0.297708, 1.41521e-08, -0.0291065, 0.954213)
bones/22/rotation = Quaternion(0.297707, -1.85442e-08, -0.0291063, 0.954213)
bones/23/position = Vector3(-1.2815e-06, 4.4579, 9.22382e-06)
bones/24/position = Vector3(5.83251, 16.5926, -0.117399)
bones/24/rotation = Quaternion(0.366161, -0.0225096, -0.0924421, 0.925675)
bones/24/scale = Vector3(1, 1, 1)
bones/25/position = Vector3(4.16018e-06, 6.3329, 4.69324e-06)
bones/25/rotation = Quaternion(0.35803, 1.21275e-07, -0.0350038, 0.933054)
bones/26/position = Vector3(-2.38419e-06, 5.6089, 2.77907e-06)
bones/26/rotation = Quaternion(0.35803, -1.3974e-08, -0.0350039, 0.933054)
bones/27/position = Vector3(-1.66893e-06, 4.4897, 9.21637e-06)
bones/28/position = Vector3(11.1436, 14.8206, 0.00178776)
bones/28/rotation = Quaternion(0.423095, -0.0260602, -0.0964468, 0.900561)
bones/29/position = Vector3(1.15572e-06, 5.5763, 3.2443e-06)
bones/29/rotation = Quaternion(0.415306, -7.47977e-05, -0.0405634, 0.908777)
bones/30/position = Vector3(5.84126e-06, 4.0902, 7.28667e-06)
bones/30/rotation = Quaternion(0.415306, -7.48756e-05, -0.0405635, 0.908777)
bones/31/position = Vector3(1.78814e-06, 4.2223, 6.10948e-07)
bones/31/rotation = Quaternion(-8.46545e-16, 1.16415e-10, 2.05044e-15, 1)
bones/32/rotation = Quaternion(0.65578, -0.406835, 0.416844, 0.48029)
bones/32/scale = Vector3(1, 1, 1)
bones/33/position = Vector3(1.29853e-05, 18.0019, -3.98788e-06)
bones/33/rotation = Quaternion(-0.0396024, 0.287934, -0.434171, 0.852656)
bones/33/scale = Vector3(1, 1, 1)
bones/34/rotation = Quaternion(0.02512, 0.178429, -0.229704, 0.956435)
bones/35/rotation = Quaternion(0.0256362, -0.0717334, -0.221965, 0.972074)
bones/35/scale = Vector3(1, 1, 1)
bones/36/rotation = Quaternion(0.416296, -0.338707, -0.289478, 0.792577)
bones/36/scale = Vector3(1, 1, 1)
bones/37/rotation = Quaternion(-0.0331704, -0.00637301, 0.266863, 0.963143)
bones/38/position = Vector3(-3.91163e-07, 4.4469, -8.94057e-07)
bones/38/rotation = Quaternion(-0.132696, -0.087882, 0.15532, 0.974959)
bones/39/position = Vector3(4.50015e-06, 5.3385, -2.77162e-06)
bones/40/position = Vector3(6.3456, 17.473, 0.144398)
bones/40/rotation = Quaternion(0.705672, -0.0609777, 0.141106, 0.691663)
bones/40/scale = Vector3(1, 1, 1)
bones/41/rotation = Quaternion(0.707409, 0.00452608, 0.0540119, 0.704723)
bones/42/position = Vector3(-6.79698e-06, 5.287, 2.8404e-06)
bones/42/rotation = Quaternion(0.10565, 0.0367728, -0.110716, 0.987536)
bones/44/position = Vector3(0.112391, 18.0096, -0.440808)
bones/44/rotation = Quaternion(0.672374, 0.0230497, 0.0338606, 0.739078)
bones/44/scale = Vector3(1, 1, 1)
bones/45/rotation = Quaternion(0.660089, -1.99305e-05, 0.0644979, 0.748413)
bones/46/rotation = Quaternion(0.660084, -2.2961e-05, 0.0645485, 0.748413)
bones/48/position = Vector3(-5.8325, 16.5924, -0.1173)
bones/48/rotation = Quaternion(0.662911, 0.127365, 0.0288649, 0.737221)
bones/48/scale = Vector3(1, 1, 1)
bones/49/position = Vector3(6.29924e-06, 6.333, 1.78771e-06)
bones/49/rotation = Quaternion(0.662521, 0.0975021, 0.0472282, 0.741167)
bones/50/position = Vector3(-3.57628e-06, 5.60899, -1.29268e-06)
bones/50/rotation = Quaternion(0.662481, 0.0975468, 0.0474537, 0.741183)
bones/51/position = Vector3(1.07288e-06, 4.49002, -1.05426e-06)
bones/52/position = Vector3(-11.1437, 14.8205, 0.00239488)
bones/52/rotation = Quaternion(0.732286, 0.221724, 0.112314, 0.63402)
bones/52/scale = Vector3(1, 1, 1)
bones/53/position = Vector3(2.99789e-06, 5.57601, -2.11115e-06)
bones/53/rotation = Quaternion(0.834408, -0.0491497, 0.0835564, 0.542554)
bones/54/rotation = Quaternion(0.350006, -5.87531e-05, 0.0343699, 0.936117)
bones/55/position = Vector3(2.98023e-06, 4.22301, 5.28991e-07)
bones/56/rotation = Quaternion(-0.124077, 0.673307, 0.727788, 0.0398363)
bones/56/scale = Vector3(1, 1, 0.999995)
bones/57/rotation = Quaternion(-0.640933, 0.0779342, -0.140274, 0.750636)
bones/58/rotation = Quaternion(0.392373, -0.0101202, 0.0269459, 0.919356)
bones/59/rotation = Quaternion(0.474932, 0.0641118, -0.208797, 0.852487)
bones/59/scale = Vector3(1, 1, 1)
bones/60/rotation = Quaternion(-1.7679e-08, 1.35886e-08, -7.42743e-09, 1)
bones/61/rotation = Quaternion(-0.189849, 0.171947, 0.912514, 0.318919)
bones/61/scale = Vector3(1, 1, 0.999995)
bones/62/rotation = Quaternion(-0.738941, -0.176801, 0.0347586, 0.64923)
bones/63/rotation = Quaternion(0.776881, 0.0981346, 0.0955993, 0.614562)
bones/63/scale = Vector3(1, 1, 1)
bones/64/rotation = Quaternion(0.561806, 0.016768, 0.149134, 0.813543)
bones/65/rotation = Quaternion(1.42063e-08, -3.44021e-08, 1.11474e-08, 1)

[node name="AnimationPlayer" parent="a_monster" index="1"]
autoplay = "running"

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_1qewk")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
height = 1.5
radius = 1.0
debug_enabled = true

[node name="Vission_area" type="Node3D" parent="." node_paths=PackedStringArray("parent")]
script = ExtResource("2_o8eyv")
parent = NodePath("..")

[node name="RayCast3D" type="RayCast3D" parent="Vission_area"]
transform = Transform3D(1, 0, 0, 0, 0.99985, -0.0172954, 0, 0.0172954, 0.99985, -0.0817828, 0.810395, -0.516692)
target_position = Vector3(0, 0, -40)
collision_mask = 6

[node name="Label3D" type="Label3D" parent="."]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 1.5, 0)
font_size = 40

[node name="enemy_movement" type="Node" parent="."]

[node name="AnimationTree" type="AnimationTree" parent="."]
active = false
root_node = NodePath("../a_monster")
tree_root = SubResource("AnimationNodeStateMachine_d2to1")
anim_player = NodePath("../a_monster/AnimationPlayer")
parameters/conditions/attack = false
parameters/conditions/going_to_pos = false
parameters/conditions/got_home = false
parameters/conditions/heard = false
parameters/conditions/lost = false
parameters/conditions/see = false

[node name="rot_point" type="Marker3D" parent="."]

[connection signal="bodies_count" from="Vission_area" to="." method="_on_vission_area_bodies_count"]
[connection signal="animation_started" from="AnimationTree" to="." method="_on_animation_tree_animation_started"]

[editable path="a_monster"]
